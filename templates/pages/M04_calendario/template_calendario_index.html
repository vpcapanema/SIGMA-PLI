<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calend√°rio PLI | SIGMA-PLI</title>

    <!-- Reset e base global -->
    <link rel="stylesheet" href="{{ url_for('static', path='/css/style_global_reset_base.css') }}">

    <!-- CSS do dashboard (navbar e footer padr√£o ESCURO como na equipe) -->
    <link rel="stylesheet" href="{{ url_for('static', path='/css/M02_dashboard/style_dashboard_layout_base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='/css/M00_home/style_home_layout_base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='/css/M00_home/style_home_cards.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='/css/M00_home/style_home_navigation.css') }}">

    <!-- CSS do m√≥dulo calend√°rio -->
    <link rel="stylesheet" href="{{ url_for('static', path='/css/M04_calendario/style_calendario_base.css') }}">

    <!-- Meta tags -->
    <meta name="description" content="Sistema de gerenciamento de calend√°rio e eventos do PLI-SP 2050">
    <meta name="author" content="SIGMA-PLI Team">
</head>

<body class="dashboard-body">
    <!-- Header/Navigation (padr√£o SIGMA-PLI igual p√°gina equipe) -->
    <header class="dashboard-header">
        <nav class="sigma-nav">
            <div class="header-brand">
                <span class="brand-title">SIGMA-PLI</span>
                <span class="brand-subtitle">Sistema Integrado de Gest√£o, Monitoramento e Apoio t√©cnico ao PLI/SP</span>
            </div>
            <div class="nav-menu">
                <a href="/" class="nav-link">Home</a>
                <a href="/sobre" class="nav-link">Sobre o PLI</a>
                <a href="/equipe" class="nav-link">Equipe</a>
                <a href="/calendario" class="nav-link active">Calend√°rio</a>
                <a href="/auth" class="nav-link">Entrar</a>
            </div>
        </nav>
    </header>

    <!-- Main Content (igual estrutura da p√°gina equipe) -->
    <main class="team-main">
        <section>
            <div class="card-main">
                <div class="container">
                    <div class="calendario-layout">

                        <!-- Header com navega√ß√£o e a√ß√µes -->
                        <header class="calendario-header">
                            <div class="calendario-header-title">
                                <h1>
                                    <span class="icon-calendar"></span> Calend√°rio PLI
                                </h1>
                            </div>

                            <div class="calendar-nav">
                                <button id="btn-prev-month" class="calendario-btn">
                                    ‚Üê Anterior
                                </button>
                                <button id="btn-today" class="calendario-btn calendario-btn-primary">
                                    Hoje
                                </button>
                                <button id="btn-next-month" class="calendario-btn">
                                    Pr√≥ximo ‚Üí
                                </button>
                            </div>

                            <div class="calendario-header-actions">
                                <button id="btn-novo-evento" class="calendario-btn calendario-btn-success">
                                    <span class="icon-plus"></span> Novo Evento
                                </button>
                                <button id="btn-exportar" class="calendario-btn">
                                    <span class="icon-download"></span> Exportar
                                </button>
                                <button id="btn-sincronizar" class="calendario-btn">
                                    <span class="icon-refresh"></span> Sincronizar
                                </button>
                            </div>
                        </header>

                        <!-- Layout principal: filtros | calend√°rio | eventos -->
                        <div class="calendario-main">

                            <!-- Sidebar esquerda: Filtros e Legenda -->
                            <aside class="calendario-sidebar-left">

                                <!-- Card de Filtros -->
                                <div class="calendario-card">
                                    <h2><span class="icon-search"></span> Busca e Filtros</h2>

                                    <div class="calendario-filters">
                                        <!-- Campo de busca -->
                                        <div class="filter-group">
                                            <label for="filter-search">Buscar eventos</label>
                                            <input type="text" id="filter-search"
                                                placeholder="Digite t√≠tulo, descri√ß√£o..." />
                                        </div>

                                        <div class="filter-group">
                                            <label for="filter-type">Tipo de Evento</label>
                                            <select id="filter-type">
                                                <option value="all">Todos</option>
                                                <option value="entrega">Entregas</option>
                                                <option value="reuniao">Reuni√µes</option>
                                                <option value="homeoffice">Home Office</option>
                                            </select>
                                        </div>

                                        <div class="filter-group">
                                            <label for="filter-user">Respons√°vel</label>
                                            <input type="text" id="filter-user" placeholder="Nome do respons√°vel..." />
                                        </div>

                                        <div class="filter-group">
                                            <label for="filter-module">M√≥dulo</label>
                                            <select id="filter-module">
                                                <option value="all">Todos os m√≥dulos</option>
                                                <option value="M00_home">M00 - Home</option>
                                                <option value="M01_auth">M01 - Autentica√ß√£o</option>
                                                <option value="M02_cadastros">M02 - Cadastros</option>
                                                <option value="M03_dicionario">M03 - Dicion√°rio</option>
                                                <option value="M04_calendario">M04 - Calend√°rio</option>
                                                <option value="M05_relatorios">M05 - Relat√≥rios</option>
                                            </select>
                                        </div>

                                        <button id="btn-limpar-filtros" class="calendario-btn calendario-btn-full">
                                            Limpar Filtros
                                        </button>

                                        <!-- Contador de resultados -->
                                        <div id="filter-results" class="filter-results">
                                            <!-- Preenchido via JS -->
                                        </div>
                                    </div>
                                </div>

                                <!-- Card de Estat√≠sticas -->
                                <div class="calendario-card calendario-card-spacing">
                                    <h2><span class="icon-chart"></span> Estat√≠sticas</h2>

                                    <div class="calendar-stats" id="calendar-stats">
                                        <div class="stat-item">
                                            <span class="stat-label">Total</span>
                                            <span class="stat-value" id="stat-total">0</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-label">Este M√™s</span>
                                            <span class="stat-value" id="stat-this-month">0</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-label">Entregas</span>
                                            <span class="stat-value stat-entrega" id="stat-entregas">0</span>
                                        </div>
                                        <div class="stat-item">
                                            <span class="stat-label">Reuni√µes</span>
                                            <span class="stat-value stat-reuniao" id="stat-reunioes">0</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Badge de notifica√ß√µes -->
                                <div id="notification-badge"
                                    class="calendario-card calendario-card-spacing calendario-notification-warning">
                                    <h3 class="calendario-warning-title"><span class="icon-warning"></span> Pr√≥ximos
                                        Eventos</h3>
                                    <p id="notification-text" class="calendario-hint"></p>
                                </div>

                            </aside>

                            <!-- Conte√∫do central: Grid do calend√°rio -->
                            <main class="calendario-content">
                                <div class="calendario-card">
                                    <!-- M√™s e Ano no topo centralizado -->
                                    <div class="calendario-month-year-display">
                                        <h2 id="monthYearLabel">
                                            <!-- Preenchido via JS: "Janeiro 2025" -->
                                        </h2>
                                    </div>

                                    <!-- Grid do calend√°rio -->
                                    <div class="calendar-grid" id="calendarGrid">
                                        <!-- Cabe√ßalhos dos dias da semana -->
                                        <div class="calendar-day-header">Dom</div>
                                        <div class="calendar-day-header">Seg</div>
                                        <div class="calendar-day-header">Ter</div>
                                        <div class="calendar-day-header">Qua</div>
                                        <div class="calendar-day-header">Qui</div>
                                        <div class="calendar-day-header">Sex</div>
                                        <div class="calendar-day-header">S√°b</div>

                                        <!-- C√©lulas dos dias (preenchidas via JS) -->
                                    </div>

                                    <!-- Legenda no final do card -->
                                    <div class="calendario-legend-bottom">
                                        <div class="legend-item">
                                            <span class="dot dot-entrega"></span>
                                            <span>Entregas</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="dot dot-reuniao"></span>
                                            <span>Reuni√µes</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="dot dot-homeoffice"></span>
                                            <span>Home Office</span>
                                        </div>
                                    </div>
                                </div>
                            </main>

                            <!-- Sidebar direita: Lista de eventos -->
                            <aside class="calendario-sidebar-right">
                                <div class="calendario-card">
                                    <h2><span class="icon-list"></span> Eventos do Dia</h2>

                                    <div id="selected-date-label" class="calendario-selected-date">
                                        Selecione um dia no calend√°rio
                                    </div>

                                    <div id="eventos-list-container" class="calendario-eventos-container">
                                        <!-- Lista de eventos preenchida via JS -->
                                        <div class="calendario-empty">
                                            Nenhum evento para esta data
                                        </div>
                                    </div>
                                </div>

                                <!-- Card de atalhos -->
                                <div class="calendario-card calendario-card-spacing">
                                    <h2><span class="icon-bolt"></span> Atalhos</h2>

                                    <div class="calendario-atalhos-container">
                                        <button class="calendario-btn calendario-btn-full"
                                            onclick="CalendarioIntegrations.addToGoogleCalendar()">
                                            <span class="icon-calendar"></span> Adicionar a Google Calendar
                                        </button>
                                        <button class="calendario-btn calendario-btn-full"
                                            onclick="CalendarioIntegrations.addToOutlook()">
                                            <span class="icon-email"></span> Adicionar a Outlook
                                        </button>
                                        <button class="calendario-btn calendario-btn-full"
                                            onclick="CalendarioExport.exportICS()">
                                            <span class="icon-save"></span> Baixar .ics (iCalendar)
                                        </button>
                                    </div>
                                </div>
                            </aside>

                        </div>

                    </div>
                </div>
        </section>
    </main>

    <!-- Footer (igual p√°gina equipe) -->
    <footer class="dashboard-footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2025 SIGMA-PLI. Desenvolvido e implementado por VPC-GEOSER</p>
            </div>
        </div>
    </footer>

    <!-- Modal para criar/editar evento -->
    <div id="modal-evento" class="calendario-modal">
        <div class="calendario-modal-overlay"></div>
        <div class="calendario-modal-content">
            <div class="calendario-modal-header">
                <h2 id="modal-title">Novo Evento</h2>
                <button class="calendario-modal-close" id="btn-close-modal">&times;</button>
            </div>

            <form id="form-evento" class="calendario-modal-body">
                <input type="hidden" id="evento-id" name="id">

                <div class="form-group">
                    <label for="evento-titulo">T√≠tulo *</label>
                    <input type="text" id="evento-titulo" name="titulo" required
                        placeholder="Ex: Reuni√£o de Planejamento">
                </div>

                <div class="form-group">
                    <label for="evento-descricao">Descri√ß√£o</label>
                    <textarea id="evento-descricao" name="descricao" rows="3"
                        placeholder="Descreva os detalhes do evento..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="evento-data-inicio">Data In√≠cio *</label>
                        <input type="date" id="evento-data-inicio" name="data_inicio" required>
                    </div>

                    <div class="form-group">
                        <label for="evento-hora-inicio">Hora In√≠cio</label>
                        <input type="time" id="evento-hora-inicio" name="hora_inicio" value="09:00">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="evento-data-fim">Data Fim</label>
                        <input type="date" id="evento-data-fim" name="data_fim">
                    </div>

                    <div class="form-group">
                        <label for="evento-hora-fim">Hora Fim</label>
                        <input type="time" id="evento-hora-fim" name="hora_fim" value="10:00">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="evento-tipo">Tipo de Evento *</label>
                        <select id="evento-tipo" name="tipo" required>
                            <option value="">Selecione...</option>
                            <option value="entrega">Entrega</option>
                            <option value="reuniao">Reuni√£o</option>
                            <option value="homeoffice">Home Office</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="evento-modulo">M√≥dulo</label>
                        <select id="evento-modulo" name="modulo">
                            <option value="">Selecione...</option>
                            <option value="M00_home">M00 - Home</option>
                            <option value="M01_auth">M01 - Autentica√ß√£o</option>
                            <option value="M02_cadastros">M02 - Cadastros</option>
                            <option value="M03_dicionario">M03 - Dicion√°rio</option>
                            <option value="M04_calendario">M04 - Calend√°rio</option>
                            <option value="M05_relatorios">M05 - Relat√≥rios</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="evento-responsavel">Respons√°vel</label>
                    <input type="text" id="evento-responsavel" name="responsavel" placeholder="Nome do respons√°vel">
                </div>

                <div class="form-group">
                    <label for="evento-localizacao">Localiza√ß√£o</label>
                    <input type="text" id="evento-localizacao" name="localizacao"
                        placeholder="Ex: Sala de Reuni√µes, Online, etc.">
                </div>

                <div class="calendario-modal-footer">
                    <button type="button" class="calendario-btn" id="btn-cancel-modal">
                        Cancelar
                    </button>
                    <button type="submit" class="calendario-btn calendario-btn-success">
                        <span class="icon-save"></span> Salvar Evento
                    </button>
                </div>
            </form>
        </div>
    </div> <!-- Scripts do m√≥dulo calend√°rio (ordem importante) -->
    <script src="{{ url_for('static', path='/js/M04_calendario/script_calendario_main.js') }}"></script>
    <script src="{{ url_for('static', path='/js/M04_calendario/script_calendario_api.js') }}"></script>
    <script src="{{ url_for('static', path='/js/M04_calendario/script_calendario_integrations.js') }}"></script>

    <!-- Inicializa√ß√£o -->
    <script>
        // Garante que o calend√°rio seja inicializado ap√≥s o DOM estar pronto
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function () {
                console.log('üìÖ Inicializando m√≥dulo calend√°rio...');
                initCalendario();
                CalendarioSync.sync();
            });
        } else {
            console.log('üìÖ Inicializando m√≥dulo calend√°rio...');
            initCalendario();
            CalendarioSync.sync();
        }

        // Event listeners para bot√µes do header
        document.addEventListener('DOMContentLoaded', function () {
            // Navega√ß√£o
            document.getElementById('btn-prev-month')?.addEventListener('click', CalendarioNavigation.prevMonth);
            document.getElementById('btn-next-month')?.addEventListener('click', CalendarioNavigation.nextMonth);
            document.getElementById('btn-today')?.addEventListener('click', CalendarioNavigation.goToday);

            // A√ß√µes
            document.getElementById('btn-novo-evento')?.addEventListener('click', function () {
                CalendarioModal.open();
            });

            document.getElementById('btn-exportar')?.addEventListener('click', function () {
                CalendarioExport.showExportMenu();
            });

            document.getElementById('btn-sincronizar')?.addEventListener('click', function () {
                CalendarioSync.sync();
                alert('‚úÖ Sincroniza√ß√£o iniciada!');
            });

            document.getElementById('btn-limpar-filtros')?.addEventListener('click', function () {
                document.getElementById('filter-search').value = '';
                document.getElementById('filter-type').value = 'all';
                document.getElementById('filter-user').value = '';
                document.getElementById('filter-module').value = 'all';
                CalendarioFilters.updateFilters();
            });
        });
    </script>
</body>

</html>