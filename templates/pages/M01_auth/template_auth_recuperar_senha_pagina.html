<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Recuperar Senha - SIGMA-PLI</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Estilos Globais -->
  <link href="/static/css/style_global_reset_base.css" rel="stylesheet">
  <!-- Estilos do Dashboard (para navbar) -->
  <link href="/static/css/M02_dashboard/style_dashboard_layout_base.css" rel="stylesheet">
  <!-- Estilos da Navegação Home -->
  <link href="/static/css/M00_home/style_home_navigation.css" rel="stylesheet">
  <!-- Estilos desta Página -->
  <link href="/static/css/M01_auth/style_auth_recuperar_senha.css" rel="stylesheet">
</head>

<body class="recuperar-senha__p-recuperar-senha--body dashboard-body">
  <!-- HEADER - NAVBAR -->
  <header class="login__l-header--header dashboard-header">
    <nav class="sigma-nav">
      <div class="header-brand">
        <span class="brand-title">SIGMA-PLI</span>
        <span class="brand-subtitle">Módulo de Gerenciamento de Cadastros</span>
      </div>
      <div class="nav-menu">
        <a href="/auth" class="nav-link">Início</a>
        <a href="/auth/login" class="nav-link">Login</a>
        <a href="/" class="nav-link">Home SIGMA</a>
      </div>
    </nav>
  </header>

  <!-- Área Central -->
  <div class="pli-main-content">
    <div class="container">
      <!-- Container de Recuperação -->
      <div class="recuperar-senha__recovery-container--div">
        
        <!-- Header com Título e Progresso -->
        <div class="recuperar-senha__recovery-header--div">
          <div class="recuperar-senha__recovery-icon--div">
            <i class="fas fa-key" id="headerIcon"></i>
          </div>
          <h1 class="pli-title text-center mb-2" id="headerTitle">Recuperar Senha</h1>
          <p class="text-center text-muted mb-4" id="headerSubtitle">
            Siga os passos abaixo para redefinir sua senha
          </p>
          
          <!-- Indicador de Progresso -->
          <div class="recuperar-senha__progress-container--div" id="progressContainer">
            <div class="recuperar-senha__progress-bar--div">
              <div class="recuperar-senha__progress-fill--div" id="progressFill"></div>
            </div>
            <div class="recuperar-senha__progress-steps--div">
              <div class="recuperar-senha__progress-step--div recuperar-senha__active--div" id="progressStep1">
                <div class="recuperar-senha__progress-step-circle--div">
                  <i class="fas fa-envelope"></i>
                </div>
                <span class="recuperar-senha__progress-step-label--span">Email</span>
              </div>
              <div class="recuperar-senha__progress-step--div" id="progressStep2">
                <div class="recuperar-senha__progress-step-circle--div">
                  <i class="fas fa-shield-alt"></i>
                </div>
                <span class="recuperar-senha__progress-step-label--span">Token</span>
              </div>
              <div class="recuperar-senha__progress-step--div" id="progressStep3">
                <div class="recuperar-senha__progress-step-circle--div">
                  <i class="fas fa-lock"></i>
                </div>
                <span class="recuperar-senha__progress-step-label--span">Nova Senha</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Container de Alertas -->
        <div id="alertContainer" class="mb-4"></div>

        <!-- Cards Container -->
        <div class="recuperar-senha__cards-wrapper--div">
            
            <!-- STEP 1: Email -->
            <div class="card recuperar-senha__step-card--div recuperar-senha__active--div" id="cardEmail">
              <div class="card-body p-4">
                <div class="text-center mb-4">
                  <div class="recuperar-senha__step-number--div mb-3">
                    <i class="fas fa-envelope"></i>
                  </div>
                  <h4 class="recuperar-senha__step-title--h5 mb-2">Digite seu Email</h4>
                  <p class="text-muted" style="font-size: 0.9rem;">Informe o email cadastrado para receber o código</p>
                </div>

                <div id="feedbackEmail"></div>
                
                <form id="emailForm" novalidate>
                  <div class="form-floating mb-4">
                    <input class="form-control recuperar-senha__input--input" id="email" name="email" placeholder="email@exemplo.com" required type="email">
                    <label for="email"><i class="fas fa-envelope me-2"></i>Endereço de Email</label>
                    <div class="invalid-feedback">Digite um email válido.</div>
                  </div>
                  
                  <button class="btn btn-primary btn-lg w-100 recuperar-senha__btn-next--button" id="btnSendEmail" type="submit">
                    <i class="fas fa-paper-plane me-2"></i>Enviar Código
                  </button>
                </form>
              </div>
            </div>

            <!-- STEP 2: Token -->
            <div class="card recuperar-senha__step-card--div" id="cardToken">
              <div class="card-body p-4">
                <div class="text-center mb-4">
                  <div class="recuperar-senha__step-number--div mb-3">
                    <i class="fas fa-shield-alt"></i>
                  </div>
                  <h4 class="recuperar-senha__step-title--h5 mb-2">Verifique seu Email</h4>
                  <p class="text-muted" style="font-size: 0.85rem;">
                    Enviamos um código para<br>
                    <strong class="text-primary" id="emailDisplay"></strong>
                  </p>
                </div>

                <div id="feedbackToken"></div>
                
                <form id="tokenForm" novalidate>
                  <div class="form-floating mb-3">
                    <input autocomplete="one-time-code" class="form-control recuperar-senha__input--input text-center" id="token" maxlength="6" name="token" placeholder="000000" required type="text" style="letter-spacing: 0.4rem; font-size: 1.4rem;">
                    <label for="token"><i class="fas fa-key me-2"></i>Código de 6 Dígitos</label>
                    <div class="invalid-feedback">Digite o código de 6 dígitos.</div>
                  </div>
                  
                  <div class="text-center mb-4">
                    <small class="text-muted">
                      Não recebeu o código? 
                      <a class="recuperar-senha__resend-link--a" href="#" id="resendLink">Reenviar código</a>
                    </small>
                    <div class="recuperar-senha__resend-timer--div mt-1" id="resendTimer"></div>
                  </div>
                  
                  <button class="btn btn-primary btn-lg w-100 recuperar-senha__btn-next--button mb-2" id="btnVerifyToken" type="submit">
                    <i class="fas fa-check me-2"></i>Verificar Código
                  </button>
                  
                  <button class="btn btn-outline-secondary w-100" onclick="goToStep(1)" type="button">
                    <i class="fas fa-arrow-left me-2"></i>Voltar
                  </button>
                </form>
              </div>
            </div>

            <!-- STEP 3: Nova Senha -->
            <div class="card recuperar-senha__step-card--div" id="cardPassword">
              <div class="card-body p-4">
                <div class="text-center mb-4">
                  <div class="recuperar-senha__step-number--div mb-3">
                    <i class="fas fa-lock"></i>
                  </div>
                  <h4 class="recuperar-senha__step-title--h5 mb-2">Crie sua Nova Senha</h4>
                  <p class="text-muted" style="font-size: 0.9rem;">Escolha uma senha forte e segura</p>
                </div>

                <div id="feedbackPassword"></div>
                
                <form id="passwordForm" novalidate>
                  <!-- Nova Senha -->
                  <div class="input-group mb-3">
                    <input autocomplete="new-password" class="form-control recuperar-senha__input--input" id="newPassword" name="newPassword" placeholder="Nova senha" required type="password">
                    <button class="btn btn-outline-secondary" id="toggleNewPassword" type="button" title="Mostrar/Ocultar senha">
                      <i class="fas fa-eye"></i>
                    </button>
                  </div>
                  
                  <!-- Confirmar Senha -->
                  <div class="input-group mb-3">
                    <input autocomplete="new-password" class="form-control recuperar-senha__input--input" id="confirmPassword" name="confirmPassword" placeholder="Confirmar senha" required type="password">
                    <button class="btn btn-outline-secondary" id="toggleConfirmPassword" type="button" title="Mostrar/Ocultar senha">
                      <i class="fas fa-eye"></i>
                    </button>
                  </div>

                  <!-- Força da Senha -->
                  <div class="recuperar-senha__password-strength--div mb-3">
                    <div class="recuperar-senha__password-strength-bar--div">
                      <div class="recuperar-senha__password-strength-fill--div" data-strength="weak" id="strengthFill"></div>
                    </div>
                    <small class="recuperar-senha__password-strength-text--small" id="strengthText">Força da senha: Fraca</small>
                  </div>

                  <!-- Checklist -->
                  <ul class="recuperar-senha__password-checklist--ul mb-3">
                    <li class="recuperar-senha__unchecked--li" id="chk-length">
                      <span class="recuperar-senha__uncheck--span"><i class="fas fa-times-circle"></i></span> Mínimo 8 caracteres
                    </li>
                    <li class="recuperar-senha__unchecked--li" id="chk-upper">
                      <span class="recuperar-senha__uncheck--span"><i class="fas fa-times-circle"></i></span> Letra maiúscula (A-Z)
                    </li>
                    <li class="recuperar-senha__unchecked--li" id="chk-lower">
                      <span class="recuperar-senha__uncheck--span"><i class="fas fa-times-circle"></i></span> Letra minúscula (a-z)
                    </li>
                    <li class="recuperar-senha__unchecked--li" id="chk-number">
                      <span class="recuperar-senha__uncheck--span"><i class="fas fa-times-circle"></i></span> Número (0-9)
                    </li>
                    <li class="recuperar-senha__unchecked--li" id="chk-special">
                      <span class="recuperar-senha__uncheck--span"><i class="fas fa-times-circle"></i></span> Caractere especial (!@#$%)
                    </li>
                  </ul>

                  <!-- Match Indicator -->
                  <div class="recuperar-senha__password-match-indicator--div mb-4 recuperar-senha__hidden--div" id="passwordMatchIndicator">
                    <div class="recuperar-senha__password-match-success--div recuperar-senha__hidden--div" id="passwordMatchSuccess">
                      <i class="fas fa-check-circle me-2"></i>Senhas coincidem
                    </div>
                    <div class="recuperar-senha__password-match-error--div recuperar-senha__hidden--div" id="passwordMatchError">
                      <i class="fas fa-times-circle me-2"></i>Senhas não coincidem
                    </div>
                  </div>
                  
                  <button class="btn btn-success btn-lg w-100 recuperar-senha__btn-next--button mb-2" id="btnResetPassword" type="submit">
                    <i class="fas fa-save me-2"></i>Alterar Senha
                  </button>
                  
                  <button class="btn btn-outline-secondary w-100" onclick="goToStep(2)" type="button">
                    <i class="fas fa-arrow-left me-2"></i>Voltar
                  </button>
                </form>
              </div>
            </div>

        </div>

        <!-- Tela de Sucesso -->
        <div class="recuperar-senha__cards-wrapper--div recuperar-senha__hidden--div" id="stepSuccess">
            <div class="card recuperar-senha__success-card--div">
              <div class="card-body text-center p-5">
                <div class="recuperar-senha__success-icon--div mb-4">
                  <i class="fas fa-check-circle"></i>
                </div>
                <h3 class="recuperar-senha__success-title--h3 mb-3">Senha Alterada com Sucesso!</h3>
                <p class="recuperar-senha__success-text--p mb-4">
                  Sua senha foi redefinida. Você já pode fazer login com a nova senha.
                </p>
                <a class="btn btn-primary btn-lg" href="/auth/login">
                  <i class="fas fa-sign-in-alt me-2"></i>Ir para o Login
                </a>
              </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-4">
          <a class="recuperar-senha__back-to-login--a" href="/auth/login">
            <i class="fas fa-arrow-left me-2"></i>Voltar ao Login
          </a>
        </div>

      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="login__l-footer--footer dashboard-footer">
    <div class="pli-footer pli-footer--compact">
      <div class="pli-footer__container container">
        <div class="pli-footer__content footer-content">
          <!-- Grupo 1: Logo e sistema -->
          <div class="pli-footer__group footer-section">
            <div class="pli-footer__logo">
              <i class="fas fa-building me-1"></i>
              SIGMA-Sistema de Gerenciamento de Cadastro
            </div>
          </div>
          <!-- Grupo 2: Links do footer -->
          <nav class="pli-footer__links footer-section">
            <a class="pli-footer__link" href="/auth/sobre">
              Sobre
            </a>
            <span class="pli-footer__sep">•</span>
            <a class="pli-footer__link" href="/contato">
              Contato
            </a>
            <span class="pli-footer__sep">•</span>
            <a class="pli-footer__link" href="/privacidade">
              Privacidade
            </a>
            <span class="pli-footer__sep">•</span>
            <a class="pli-footer__link" href="/termos">
              Termos
            </a>
          </nav>
        </div>
        <!-- Grupo 3: Copyright -->
        <div class="pli-footer__bottom footer-bottom">
          <div class="pli-footer__copyright">
            © 2025 SIGMA-PLI • Módulo de Gerenciamento de Cadastros
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Font Awesome -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
  <!-- Script da Página -->
  <script src="/static/js/M01_auth/script_auth_recuperar_senha.js"></script>
</body>

</html>
