{% extends 'pages/M01_auth/template_base_auth.html' %}

{% block title %}Pessoas Físicas | SIGMA-PLI{% endblock %}

{% block extra_head %}
  <link href="/static/css/M01_auth/style_pessoa_fisica.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="pli-main-content">
  <main class="container-fluid py-4">
    <!-- Cabeçalho -->
    <div class="row mb-4">
      <div class="col-12 d-flex justify-content-between align-items-center flex-wrap gap-3">
        <div>
          <h1 class="h2 section-title">
            <i class="fas fa-user text-primary"></i>
            Gestão de Pessoas Físicas
          </h1>
          <p class="text-muted mb-0">Cadastre e gerencie pessoas físicas no sistema SIGMA-PLI</p>
        </div>
        <div class="d-flex gap-2">
          <button class="btn btn-outline-secondary" id="btnExportar" type="button">
            <i class="fas fa-download me-2"></i>
            Exportar
          </button>
          <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#pessoaFisicaModal" id="btnNovo" type="button">
            <i class="fas fa-plus me-2"></i>
            Nova Pessoa Física
          </button>
        </div>
      </div>
    </div>

    <!-- Estatísticas Rápidas -->
    <div class="row mb-4">
      <div class="col-md-3">
        <div class="card border-primary">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-muted mb-1">Total Cadastrados</h6>
                <h3 class="mb-0" id="totalCadastrados">-</h3>
              </div>
              <div class="metric-icon bg-primary">
                <i class="fas fa-users"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card border-success">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-muted mb-1">Cadastros Ativos</h6>
                <h3 class="mb-0" id="totalAtivos">-</h3>
              </div>
              <div class="metric-icon bg-success">
                <i class="fas fa-user-check"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card border-warning">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-muted mb-1">Pendentes Validação</h6>
                <h3 class="mb-0" id="totalPendentes">-</h3>
              </div>
              <div class="metric-icon bg-warning">
                <i class="fas fa-clock"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card border-info">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-muted mb-1">Novos (Mês)</h6>
                <h3 class="mb-0" id="totalNovosMes">-</h3>
              </div>
              <div class="metric-icon bg-info">
                <i class="fas fa-calendar-plus"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filtros de Busca -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card">
          <div class="card-header bg-light">
            <h5 class="mb-0">
              <i class="fas fa-filter text-primary"></i>
              Filtros de Busca
            </h5>
          </div>
          <div class="card-body">
            <div class="row g-3">
              <div class="col-md-3">
                <label class="form-label" for="filtroNome">Nome Completo</label>
                <input class="form-control" id="filtroNome" placeholder="Buscar por nome" type="text">
              </div>
              <div class="col-md-3">
                <label class="form-label" for="filtroCpf">CPF</label>
                <input class="form-control" id="filtroCpf" placeholder="000.000.000-00" type="text">
              </div>
              <div class="col-md-3">
                <label class="form-label" for="filtroEmail">E-mail</label>
                <input class="form-control" id="filtroEmail" placeholder="email@exemplo.com" type="email">
              </div>
              <div class="col-md-3">
                <label class="form-label" for="filtroStatus">Status</label>
                <select class="form-select" id="filtroStatus">
                  <option value="">Todos</option>
                  <option value="ativo">Ativo</option>
                  <option value="pendente">Pendente</option>
                  <option value="inativo">Inativo</option>
                </select>
              </div>
              <div class="col-12">
                <div class="d-flex gap-2">
                  <button class="btn btn-primary" id="btnBuscar" type="button">
                    <i class="fas fa-search me-2"></i>
                    Buscar
                  </button>
                  <button class="btn btn-secondary" id="btnLimpar" type="button">
                    <i class="fas fa-eraser me-2"></i>
                    Limpar Filtros
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabela de Resultados -->
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header bg-light d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              <i class="fas fa-table text-primary"></i>
              Lista de Pessoas Físicas
            </h5>
            <span class="badge bg-primary" id="totalRegistros">0 registros</span>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped table-hover align-middle" id="pessoaFisicaTable">
                <thead class="table-light">
                  <tr>
                    <th style="width: 5%">
                      <input type="checkbox" class="form-check-input" id="selectAll">
                    </th>
                    <th style="width: 25%">Nome Completo</th>
                    <th style="width: 15%">CPF</th>
                    <th style="width: 15%">Telefone</th>
                    <th style="width: 20%">E-mail</th>
                    <th style="width: 10%">Status</th>
                    <th style="width: 10%" class="text-center">Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="7" class="text-center text-muted py-5">
                      <i class="fas fa-spinner fa-spin fa-2x mb-3 d-block"></i>
                      <p class="mb-0">Carregando dados...</p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <!-- Paginação -->
            <nav aria-label="Navegação de página">
              <ul class="pagination justify-content-end mb-0" id="pagination">
                <li class="page-item disabled">
                  <a class="page-link" href="#" tabindex="-1">Anterior</a>
                </li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                  <a class="page-link" href="#">Próximo</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>

  </main>
</div>

<!-- Modal: Cadastro/Edição de Pessoa Física -->
<div class="modal fade" id="pessoaFisicaModal" tabindex="-1" aria-labelledby="pessoaFisicaModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="pessoaFisicaModalLabel">
          <i class="fas fa-user-plus me-2"></i>
          <span id="modalTitle">Nova Pessoa Física</span>
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <form id="pessoaFisicaForm" novalidate>
        <div class="modal-body">
          <input type="hidden" id="pessoaId" name="id">
          
          <!-- Dados Pessoais -->
          <h6 class="border-bottom pb-2 mb-3">
            <i class="fas fa-id-card text-primary me-2"></i>
            Dados Pessoais
          </h6>
          <div class="row g-3 mb-4">
            <div class="col-md-12">
              <label class="form-label" for="nomeCompleto">
                Nome Completo <span class="text-danger">*</span>
              </label>
              <input class="form-control" id="nomeCompleto" name="nome_completo" required type="text">
              <div class="invalid-feedback">Por favor, informe o nome completo.</div>
            </div>
            <div class="col-md-6">
              <label class="form-label" for="cpf">
                CPF <span class="text-danger">*</span>
              </label>
              <input class="form-control" id="cpf" name="cpf" placeholder="000.000.000-00" required type="text">
              <div class="invalid-feedback">Por favor, informe um CPF válido.</div>
            </div>
            <div class="col-md-6">
              <label class="form-label" for="dataNascimento">
                Data de Nascimento <span class="text-danger">*</span>
              </label>
              <input class="form-control" id="dataNascimento" name="data_nascimento" required type="date">
              <div class="invalid-feedback">Por favor, informe a data de nascimento.</div>
            </div>
            <div class="col-md-6">
              <label class="form-label" for="rg">RG</label>
              <input class="form-control" id="rg" name="rg" type="text">
            </div>
            <div class="col-md-6">
              <label class="form-label" for="orgaoEmissor">Órgão Emissor</label>
              <input class="form-control" id="orgaoEmissor" name="orgao_emissor" type="text">
            </div>
          </div>

          <!-- Contato -->
          <h6 class="border-bottom pb-2 mb-3">
            <i class="fas fa-phone text-primary me-2"></i>
            Informações de Contato
          </h6>
          <div class="row g-3 mb-4">
            <div class="col-md-6">
              <label class="form-label" for="telefone">
                Telefone <span class="text-danger">*</span>
              </label>
              <input class="form-control" id="telefone" name="telefone" placeholder="(00) 0000-0000" required type="tel">
              <div class="invalid-feedback">Por favor, informe o telefone.</div>
            </div>
            <div class="col-md-6">
              <label class="form-label" for="celular">Celular</label>
              <input class="form-control" id="celular" name="celular" placeholder="(00) 00000-0000" type="tel">
            </div>
            <div class="col-md-12">
              <label class="form-label" for="email">
                E-mail <span class="text-danger">*</span>
              </label>
              <input class="form-control" id="email" name="email" required type="email">
              <div class="invalid-feedback">Por favor, informe um e-mail válido.</div>
            </div>
          </div>

          <!-- Endereço -->
          <h6 class="border-bottom pb-2 mb-3">
            <i class="fas fa-map-marker-alt text-primary me-2"></i>
            Endereço
          </h6>
          <div class="row g-3">
            <div class="col-md-4">
              <label class="form-label" for="cep">CEP</label>
              <input class="form-control" id="cep" name="cep" placeholder="00000-000" type="text">
            </div>
            <div class="col-md-8">
              <label class="form-label" for="logradouro">Logradouro</label>
              <input class="form-control" id="logradouro" name="logradouro" type="text">
            </div>
            <div class="col-md-4">
              <label class="form-label" for="numero">Número</label>
              <input class="form-control" id="numero" name="numero" type="text">
            </div>
            <div class="col-md-8">
              <label class="form-label" for="complemento">Complemento</label>
              <input class="form-control" id="complemento" name="complemento" type="text">
            </div>
            <div class="col-md-6">
              <label class="form-label" for="bairro">Bairro</label>
              <input class="form-control" id="bairro" name="bairro" type="text">
            </div>
            <div class="col-md-4">
              <label class="form-label" for="cidade">Cidade</label>
              <input class="form-control" id="cidade" name="cidade" type="text">
            </div>
            <div class="col-md-2">
              <label class="form-label" for="uf">UF</label>
              <select class="form-select" id="uf" name="uf">
                <option value="">--</option>
                <option value="AC">AC</option>
                <option value="AL">AL</option>
                <option value="AP">AP</option>
                <option value="AM">AM</option>
                <option value="BA">BA</option>
                <option value="CE">CE</option>
                <option value="DF">DF</option>
                <option value="ES">ES</option>
                <option value="GO">GO</option>
                <option value="MA">MA</option>
                <option value="MT">MT</option>
                <option value="MS">MS</option>
                <option value="MG">MG</option>
                <option value="PA">PA</option>
                <option value="PB">PB</option>
                <option value="PR">PR</option>
                <option value="PE">PE</option>
                <option value="PI">PI</option>
                <option value="RJ">RJ</option>
                <option value="RN">RN</option>
                <option value="RS">RS</option>
                <option value="RO">RO</option>
                <option value="RR">RR</option>
                <option value="SC">SC</option>
                <option value="SP">SP</option>
                <option value="SE">SE</option>
                <option value="TO">TO</option>
              </select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            <i class="fas fa-times me-2"></i>
            Cancelar
          </button>
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save me-2"></i>
            Salvar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

{% endblock %}

{% block extra_js %}
  <script src="/static/js/services/api.js"></script>
  <script src="/static/js/M01_auth/script_pessoa_fisica.js"></script>
{% endblock %}
